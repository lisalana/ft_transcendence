┌─────────────────────────────────────────────────────────────┐
│ 1. User clique "Login with Google"                          │
└──────────────────────┬──────────────────────────────────────┘
                       ↓
┌─────────────────────────────────────────────────────────────┐
│ 2. OAuth callback - User trouvé en DB                       │
│    → A-t-il 2FA activé ?                                    │
└──────────────────────┬──────────────────────────────────────┘
                       ↓
              ┌────────┴────────┐
              │                 │
         Non  │                 │  Oui
              ↓                 ↓
    ┌─────────────────┐  ┌──────────────────────┐
    │ generateToken   │  │ generateTwoFactor    │
    │ Pair()          │  │ Token()              │
    │ ↓               │  │ ↓                    │
    │ accessToken     │  │ tempToken            │
    │ refreshToken    │  │ (5 min)              │
    └────────┬────────┘  └──────┬───────────────┘
             │                  │
             │                  ↓
             │           ┌──────────────────────┐
             │           │ Frontend affiche     │
             │           │ "Entre ton code 2FA" │
             │           └──────┬───────────────┘
             │                  ↓
             │           ┌──────────────────────┐
             │           │ User entre 123456    │
             │           └──────┬───────────────┘
             │                  ↓
             │           ┌──────────────────────┐
             │           │ verifyToken()        │
             │           │ ✓ Code valide        │
             │           └──────┬───────────────┘
             │                  ↓
             │           ┌──────────────────────┐
             │           │ generateTokenPair()  │
             │           │ avec 2FA flag        │
             │           └──────┬───────────────┘
             │                  │
             └──────────────────┴───────────────────┐
                                                    ↓
                                      ┌──────────────────────┐
                                      │ User authentifié !   │
                                      │ Tokens stockés dans  │
                                      │ localStorage         │
                                      └──────────────────────┘